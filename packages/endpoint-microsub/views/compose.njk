{% extends "document.njk" %}

{% block content %}
  <div class="compose">
    <a href="{{ baseUrl }}/channels" class="back-link">
      {{ icon("previous") }} {{ __("Back") }}
    </a>

    {% if replyTo %}
    <div class="compose__context">
      {{ icon("reply") }} {{ __("microsub.compose.replyTo") }}: <a href="{{ replyTo }}">{{ replyTo }}</a>
    </div>
    {% endif %}

    {% if likeOf %}
    <div class="compose__context">
      {{ icon("like") }} {{ __("microsub.compose.likeOf") }}: <a href="{{ likeOf }}">{{ likeOf }}</a>
    </div>
    {% endif %}

    {% if repostOf %}
    <div class="compose__context">
      {{ icon("repost") }} {{ __("microsub.compose.repostOf") }}: <a href="{{ repostOf }}">{{ repostOf }}</a>
    </div>
    {% endif %}

    <form method="post" action="{{ baseUrl }}/compose">
      {% if replyTo %}
      <input type="hidden" name="in-reply-to" value="{{ replyTo }}">
      {% endif %}
      {% if likeOf %}
      <input type="hidden" name="like-of" value="{{ likeOf }}">
      {% endif %}
      {% if repostOf %}
      <input type="hidden" name="repost-of" value="{{ repostOf }}">
      {% endif %}

      {% if not likeOf and not repostOf %}
      {{ textarea({
        label: __("microsub.compose.content"),
        id: "content",
        name: "content",
        rows: 5,
        attributes: { autofocus: true }
      }) }}
      {% endif %}

      <div class="button-group">
        {{ button({
          text: __("microsub.compose.submit")
        }) }}
        <a href="{{ baseUrl }}/channels" class="button button--secondary">
          {{ __("microsub.compose.cancel") }}
        </a>
      </div>
    </form>
  </div>
{% endblock %}
