{% extends "document.njk" %}

{% block content %}
  <article class="item">
    <a href="{{ baseUrl }}/channels" class="back-link">
      {{ icon("previous") }} {{ __("Back") }}
    </a>

    {% if item.author %}
    <header class="item__author">
      {% if item.author.photo %}
      <img src="{{ item.author.photo }}" alt="" class="item__author-photo" width="48" height="48" loading="lazy">
      {% endif %}
      <div class="item__author-info">
        <span class="item__author-name">
          {% if item.author.url %}
          <a href="{{ item.author.url }}">{{ item.author.name or item.author.url }}</a>
          {% else %}
          {{ item.author.name or "Unknown" }}
          {% endif %}
        </span>
        {% if item.published %}
        <time datetime="{{ item.published }}" class="item__date">
          {{ item.published | date("PPPp", { locale: locale, timeZone: application.timeZone }) }}
        </time>
        {% endif %}
      </div>
    </header>
    {% endif %}

    {% if item.name %}
    <h2 class="item__title">{{ item.name }}</h2>
    {% endif %}

    {% if item.content %}
    <div class="item__content prose">
      {% if item.content.html %}
      {{ item.content.html | safe }}
      {% else %}
      {{ item.content.text }}
      {% endif %}
    </div>
    {% endif %}

    {% if item.photo and item.photo.length > 0 %}
    <div class="item__photos">
      {% for photo in item.photo %}
      <img src="{{ photo }}" alt="" class="item__photo" loading="lazy">
      {% endfor %}
    </div>
    {% endif %}

    {% if item["in-reply-to"] or item["like-of"] or item["repost-of"] or item["bookmark-of"] %}
    <div class="item__context">
      {% if item["in-reply-to"] %}
      <p>{{ icon("reply") }} {{ __("Reply to") }}: <a href="{{ item["in-reply-to"][0] }}">{{ item["in-reply-to"][0] }}</a></p>
      {% endif %}
      {% if item["like-of"] %}
      <p>{{ icon("like") }} {{ __("Liked") }}: <a href="{{ item["like-of"][0] }}">{{ item["like-of"][0] }}</a></p>
      {% endif %}
      {% if item["repost-of"] %}
      <p>{{ icon("repost") }} {{ __("Reposted") }}: <a href="{{ item["repost-of"][0] }}">{{ item["repost-of"][0] }}</a></p>
      {% endif %}
      {% if item["bookmark-of"] %}
      <p>{{ icon("bookmark") }} {{ __("Bookmarked") }}: <a href="{{ item["bookmark-of"][0] }}">{{ item["bookmark-of"][0] }}</a></p>
      {% endif %}
    </div>
    {% endif %}

    <footer class="item__actions">
      <a href="{{ baseUrl }}/compose?replyTo={{ item.url | urlencode }}" class="button button--secondary button--small">
        {{ icon("reply") }} {{ __("microsub.item.reply") }}
      </a>
      <a href="{{ baseUrl }}/compose?likeOf={{ item.url | urlencode }}" class="button button--secondary button--small">
        {{ icon("like") }} {{ __("microsub.item.like") }}
      </a>
      <a href="{{ baseUrl }}/compose?repostOf={{ item.url | urlencode }}" class="button button--secondary button--small">
        {{ icon("repost") }} {{ __("microsub.item.repost") }}
      </a>
      <a href="{{ item.url }}" class="button button--secondary button--small" target="_blank" rel="noopener">
        {{ icon("public") }} {{ __("microsub.item.viewOriginal") }}
      </a>
    </footer>
  </article>
{% endblock %}
